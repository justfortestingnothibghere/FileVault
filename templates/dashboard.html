{% extends "base.html" %}
{% block content %}
<h2 class="text-center mb-4"><i class="fas fa-cogs"></i> Dashboard</h2>

<div id="stats" class="row mb-4 text-center">
  <div class="col">
    <div class="card bg-primary text-white">
      <div class="card-body">
        <h5>Total Sites</h5>
        <h3 id="total">0</h3>
      </div>
    </div>
  </div>
  <div class="col">
    <div class="card bg-success text-white">
      <div class="card-body">
        <h5>Active</h5>
        <h3 id="active">0</h3>
      </div>
    </div>
  </div>
  <div class="col">
    <div class="card bg-danger text-white">
      <div class="card-body">
        <h5>Failed</h5>
        <h3 id="failed">0</h3>
      </div>
    </div>
  </div>
</div>

<div id="sitesList">
  {% for site in sites %}
  <div class="card mb-3">
    <div class="card-body d-flex justify-content-between align-items-center">
      <div>
        <h6><a href="{{ site.url }}" target="_blank">{{ site.url }}</a></h6>
        <small class="text-muted">
          {{ site.method }} • {{ site.interval_min }}–{{ site.interval_max }}s
          • Fails: <strong>{{ site.fails }}</strong>
          • Last: {{ site.last_ping.strftime('%H:%M:%S') if site.last_ping else 'Never' }}
        </small>
      </div>
      <div class="btn-group">
        {% if site.active %}
          <a href="{{ url_for('site_action', site_id=site.id, action='pause') }}" class="btn btn-warning btn-sm">Pause</a>
        {% else %}
          <a href="{{ url_for('site_action', site_id=site.id, action='resume') }}" class="btn btn-success btn-sm">Resume</a>
        {% endif %}
        <a href="{{ url_for('site_action', site_id=site.id, action='redeploy') }}" class="btn btn-info btn-sm">Redeploy</a>
        <a href="{{ url_for('site_action', site_id=site.id, action='delete') }}" class="btn btn-danger btn-sm" onclick="return confirm('Delete?')">Delete</a>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}